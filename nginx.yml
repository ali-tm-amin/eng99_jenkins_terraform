---
# Which host do we need to install nginx in
- hosts: app

# What facts do we want to see whilst installing
  gather_facts: true

# Do we need admin access? yes
  become: true

# What task do we want to perform in this yml file?
  tasks:
  - name: Install Nginx in web agent node
    apt: pkg=nginx state=present
  

  - name: Setting reverse proxy
      shell: |
        #git clone https://github.com/ali-tm-amin/eng99_jenkins_terraform.git
        sudo rm -rf /etc/nginx/sites-available/default
        scp ./app/default /etc/nginx/sites-available/default
      

  - name: Restart Ngnix
    shell: |
      sudo systemctl restart nginx
    become_user: root